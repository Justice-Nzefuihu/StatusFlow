[supervisord]
nodaemon=true
user=root
logfile=/dev/stdout
pidfile=/tmp/supervisord.pid

[program:xvfb]
command=Xvfb :99 -screen 0 1280x720x24
priority=1
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr

[program:celery_worker]
command=su appuser -c "celery -A app.celery_app worker --loglevel=info"
priority=2
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr

[program:celery_beat]
command=su appuser -c "celery -A app.celery_app beat --loglevel=info --schedule=/tmp/celerybeat-schedule"
priority=3
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr

[program:uvicorn]
command=su appuser -c "uvicorn app.dummy:app --host 0.0.0.0 --port 8080"
priority=4
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr
